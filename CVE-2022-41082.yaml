id: CVE-2022-41082

info:
  name: Microsoft Exchange Server Remote Code Execution Vulnerability.
  author: premium_1337
  severity: critical
  description: |
    Microsoft Exchange Server Elevation of Privilege Vulnerability
  reference:
    - https://packetstormsecurity.com/files/170066/Microsoft-Exchange-ProxyNotShell-Remote-Code-Execution.html
    - https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-41082
    - https://www.kb.cert.org/vuls/id/915563
    - https://www.secpod.com/blog/microsoft-november-2022-patch-tuesday-patches-65-vulnerabilities-including-6-zero-days/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: 2022-41082
  tags: cve,cve2022,41082,exchange

http:
  - method: GET
    path:
      - '{{BaseURL}}/autodiscover/autodiscover.json@Powershell.{{randstr}}.com/owa/'
    redirects: false

    matchers:
      - type: status
        status:
          - 401
      - type: word
        words:
          - "x-owa-version"